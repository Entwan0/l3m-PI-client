<mat-toolbar>
  <button mat-icon-button class="example-icon" aria-label="Menu">
    <mat-icon (click)="drawer.toggle()">menu</mat-icon>
  </button>
  <label>
    Projet intégrateur
  </label>
  <label class="spacer"></label>

  <mat-icon *ngIf="(auth.user | async) === null" [matMenuTriggerFor]="menuConnect">
    account_circle
  </mat-icon>
  <mat-icon *ngIf="auth.user | async as user" [matMenuTriggerFor]="menuDisconnect">
    <img [src]="user.photoURL">
  </mat-icon>

  <mat-menu #menuConnect="matMenu">
    <button mat-menu-item (click)="login()">
      &nbsp;
      <span>Compte Google</span>
    </button>
  </mat-menu>
  <mat-menu #menuDisconnect="matMenu">
    <button mat-menu-item (click)="logout()">
      <span >Déconnexion</span>
    </button>
  </mat-menu>
</mat-toolbar>

<mat-drawer-container class="example-container">
  <mat-drawer #drawer [mode]="mode.value">
    Placez votre menu ici...
  </mat-drawer>
  <mat-drawer-content>
    <mat-form-field>
      <mat-label>Sidenav mode</mat-label>
      <mat-select #mode value="push">
        <mat-option value="side">Side</mat-option>
        <mat-option value="over">Over</mat-option>
        <mat-option value="push">Push</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Test formulaire pour ajouter un chamis ! -->

    <div class="formulaire-Chamis-Container" *ngIf="auth.user | async as user">
      <hr/>
      <h2>Pas encore inscrit ? fait le grosse folle :</h2>
      <br/>
      <mat-form-field appearance="fill">
        <mat-label>nom</mat-label>
        <input matInput type="string" #nom>
      </mat-form-field>
      <br/>
      <mat-form-field appearance="fill">
        <mat-label>prénom</mat-label>
        <input matInput type="string" #prenom> 
      </mat-form-field>
      <br>
      <button mat-raised-button color="primary" (click)="creerNouveauChamis(user.email,nom.value,prenom.value)">M'inscrire chez les chamis !</button>
    </div>
    <br/>

    <!-- Fin formulaire ajouter un chamis ! -->

    <div *ngIf="auth.user | async as user" class="hide">
      <button (click)="creerNouveauChamis(user.email,'test','test')">Ajoutez moi aux chamis !</button>
      <b *ngFor="let post of post$ | async"> </b>
    </div>
    

    <!-- Test du fetch des chamis ! -->
    <br/>
    <hr />
    <h3> Les chamis : </h3>
    <table border="1px solid black">
      <tr>
        <th>Login</th>
        <th>nom</th>
        <th>prénom</th>
      </tr>
      <tr *ngFor="let chamis of tousLeschamis$ | async">
        <td>{{chamis.login}}</td>
        <td>{{chamis.nom}}</td>
        <td>{{chamis.prenom}}</td>
      </tr>
    </table>
    <br/>
    <hr/>
    <!-- Fin du fetch des chamis ! -->

    <!-- Test fetch des defis ! -->
    <h3> Les defis : </h3>
    <table  border="1px solid black">
      <tr>
        <th> ID </th>
        <th> Titre </th>
        <th> Date de Creation </th>
        <th> Auteur </th>
        <th> Latitude </th>
        <th> Longitude </th>
      </tr>
      <tr *ngFor="let defis of defis$ | async">
        <td> {{defis.id}} </td>
        <td> {{defis.titre}} </td>
        <td> {{defis.dateDeCreation}} </td>
        <td> {{defis.loginAuteur}} </td>
        <td> {{defis.latitude}} </td>
        <td> {{defis.longitude}} </td>
      </tr>
    </table>
    <hr />
     <!-- Fin du fetch des defis ! -->

    <yaga-map [lng]="5.724524" [lat]="45.188529" [zoom]="12">
      <yaga-tile-layer [(url)]="tileLayerUrl"></yaga-tile-layer>
     <!-- <yaga-polyline [(color)] = '#f00' [geoJSON]="https://data.mobilites-m.fr/api/lines/json?types=ligne"></yaga-polyline>-->
     <yaga-marker *ngFor="let defis of defis$ | async "
                    [lng] = defis.longitude
                    [lat] = defis.latitude
                    [display] = "true"
                    [opacity] = "1"
                    (click)="affichedefis(defis.id)"
                    [title]= defis.titre 
                    >
        <yaga-icon [iconUrl]="iconMarker" ></yaga-icon>
      </yaga-marker>
      <yaga-zoom-control> ZOOM </yaga-zoom-control>  
    </yaga-map>
  </mat-drawer-content>
</mat-drawer-container>
